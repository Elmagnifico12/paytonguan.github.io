<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#000">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-flash.min.css?v=1.0.2">















  
  
  <link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext">
  






<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.1.1">








<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: false,
    tabs: false,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeIn","post_body":"fadeIn","coll_header":"fadeIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Google是一个强大的搜索引擎，所以，这篇「Google正确食用指南」就来满足大家热爱「学习」的需求啦（都懂）。">
<meta property="og:type" content="article">
<meta property="og:title" content="Google正确食用指南">
<meta property="og:url" content="http://paytonguan.github.io/Google正确食用指南/index.html">
<meta property="og:site_name" content="Payton&#39;s blog">
<meta property="og:description" content="Google是一个强大的搜索引擎，所以，这篇「Google正确食用指南」就来满足大家热爱「学习」的需求啦（都懂）。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4e62026ce662099.jpg">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4a4420788f55838.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4a079d420513574.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4a63ff367a49951.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b1f673f8611538.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4a8e85b67114671.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4ae968a39f51810.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4c418c8efd52105.jpg">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4aece3e10759708.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4af122f9b965539.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b3d21eac346596.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4d8ec7326a67834.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4d9630f04083920.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b1046484215529.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b2ca8f02f10495.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b3760f2d362094.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b3f15afde47834.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b5bf3445792268.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b6910657561452.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4db2f34efa63321.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4b6d986e7998661.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4dc208516b19277.png">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4dd0f9a13e95368.jpg">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4c8b4b699e61319.jpg">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4d31d02ae569092.jpg">
<meta property="og:image" content="https://i.loli.net/2019/06/03/5cf4d466e79ab87441.png">
<meta property="og:updated_time" content="2019-06-03T10:30:20.381Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Google正确食用指南">
<meta name="twitter:description" content="Google是一个强大的搜索引擎，所以，这篇「Google正确食用指南」就来满足大家热爱「学习」的需求啦（都懂）。">
<meta name="twitter:image" content="https://i.loli.net/2019/06/03/5cf4e62026ce662099.jpg">





  
  
  <link rel="canonical" href="http://paytonguan.github.io/Google正确食用指南/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Google正确食用指南 | Payton's blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Payton's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Somewhere leisure.</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://paytonguan.github.io/Google正确食用指南/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Payton">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Payton's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Google正确食用指南

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              

              
                
              

              <time title="创建时间：2019-06-02 17:01:00" itemprop="dateCreated datePublished" datetime="2019-06-02T17:01:00+08:00">2019-06-02</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Technology/" itemprop="url" rel="index"><span itemprop="name">Technology</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon" title="阅读次数">
            <i class="fa fa-eye"></i>
            
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://i.loli.net/2019/06/03/5cf4e62026ce662099.jpg" alt></p>
<p>Google是一个强大的搜索引擎，所以，这篇「Google正确食用指南」就来满足大家热爱「学习」的需求啦（都懂）。</p>
<a id="more"></a>

<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前面是一些基本知识，我也只是小白，想直接看方法的可以跳过这一部分。</p>
<h3 id="技术原理"><a href="#技术原理" class="headerlink" title="技术原理"></a>技术原理</h3><p>要说明访问外网的技术原理，首先要说明一下网络的作用机制。</p>
<p>我们访问网络是通过<code>数据包的传递</code>来完成的。网站实际上是一个服务器，也就是一台电脑。我们向这台电脑发送数据包，这台电脑返回数据包给我们，就完成了访问网站的流程。</p>
<p>每台服务器都有一个<code>IP地址</code>，IP地址可以理解为我们现实生活中的地址，知道了地址，你才能准确的访问网站。</p>
<p>可是IP地址是一串很难记的数字，比如说，百度的IP地址是14.215.177.39，Google的IP地址经常变动。为了让我们容易记住，网站就把这一串地址用域名来代替，所以我们输入<code>www.baidu.com</code>，就可以访问百度了。当然，你输入<code>14.215.177.39</code>也是可以的，不信可以试一下。</p>
<p>但是域名和地址是怎样对应上的呢？这时候就需要<code>DNS</code>的帮忙了。DNS可以理解为帮你查地址的邮差，你告诉它域名，它返回给你正确的IP地址，你就可以访问到正确的网站了。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4a4420788f55838.png" alt="来源@啃芝士"></p>
<p>而这堵墙就建在你和网站之间。主要的手段有以下几个，</p>
<p><code>IP封锁</code>，当它发现你访问的IP地址是被封锁的，它就会把你拦住，让你无法访问网站。</p>
<p><code>DNS挟持</code>，有些DNS会回复错误的地址，让你无法访问正确的网站。</p>
<p><code>DNS污染</code>，DNS之间会互相交流信息，当有DNS回复错误地址时，会影响其他DNS也回复错误的地址。</p>
<p><code>关键词过滤</code>，它会对传输的数据包进行检查，如果发现有位于黑名单内的关键词，则会阻止数据包的传递。</p>
<p>具体可以看一下这几个视频。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://youtu.be/dpKb8uEMPEY</span><br><span class="line">https://youtu.be/ZT-q6mJ-e3g</span><br><span class="line">https://youtu.be/EUKmF_IKttc</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4a079d420513574.png" alt="来源@The News Lens"></p>
<h3 id="访问外网的姿势"><a href="#访问外网的姿势" class="headerlink" title="访问外网的姿势"></a>访问外网的姿势</h3><p>由于现在所使用的是黑名单模式，在黑名单上的网站IP无法访问，不在黑名单上的第三方IP就可以访问。所以现在几乎所有的方法，都是去找一台能够访问外网的电脑（服务器），让它代替你去访问，然后把数据包传给你。因为这台服务器的IP地址并没有遭到封禁，所以是可以通过审查的。</p>
<p>现在主要的方法有下面几种，都是基于上面所说的前提，只是技术细节不同。</p>
<h4 id="歪批嗯"><a href="#歪批嗯" class="headerlink" title="歪批嗯"></a>歪批嗯</h4><p>很多人都觉得<code>歪批嗯</code>（某三个英文字母的谐音）就等同于这篇文章的主题。但实际上，它的设计初衷并不是用来上外网，而是加密通讯。现在用这种方法很容易被发现，所以基本上已经废掉了。</p>
<p>但日常生活中，你也会经常接触它。举个例子，你人在外面，但你要打开校内的网站时，你就可以使用学校的这个服务。连上学校的服务器以后，就可以以校园网的身份访问校内网站，再把数据回传给你，你就可以人在外地，心系校园了（误</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4a63ff367a49951.png" alt="一个电脑端常用的客户端EasyConnect"></p>
<h4 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h4><p><code>代理</code>其实分正向代理和反向代理，要实现我们的目标，用的都是正向代理（我也不知道什么是反向代理</p>
<p>代理的设计初衷也不是上外网，而是匿名。常见的代理协议有<code>HTTP</code>、<code>HTTPS</code>、<code>Socks4</code>、<code>Socks5</code>等。</p>
<p>这四种代理协议都是把数据发给代理服务器，然后再由代理服务器转发给目的服务器。所以只要找到一台能够在国内访问外网的服务器的代理地址，就可以达到我们的目的了，具体做法后面会有。</p>
<h4 id="机场-软件"><a href="#机场-软件" class="headerlink" title="机场 / 软件"></a>机场 / 软件</h4><p>这里的<code>机场</code>当然不是我们坐飞机的机场，而是指提供节点服务的供应商。<code>节点</code>可以理解为服务器，机场会提供等级不同的节点，还附有使用教程。当然，绝大部分机场都是收费的。</p>
<p>机场的节点是通过<code>Subscribe</code>提供的，形式是一个<code>URL</code>。顾名思义，就像是你去订阅这份期刊，然后这份期刊会不定期更新自己的消息，保证这些消息是最新的。</p>
<p>很多打着<code>加速器</code>旗号的软件其实也是一个道理，当然也有一些软件是自带连接外网功能的浏览器。后面也会推荐一些好用的软件。</p>
<h4 id="各种专门的协议"><a href="#各种专门的协议" class="headerlink" title="各种专门的协议"></a>各种专门的协议</h4><p>这里的协议包括<code>v2ray</code>、<code>shadowsocks（SS）</code>、<code>shadowsocksR（SSR）</code>、<code>wireguard</code>、<code>brook</code>、<code>outline</code>等，这些协议就是为我们的目的而生的，所以它们的隐蔽性相对较高，加密方式也相对完善。但是SSR现在基本不能用了，v2ray和SS是主流的协议，速度快，安全性高。相比于SS，v2ray出现的时间比较晚，使用的人没那么多，比较推荐。下面附上v2ray的Github地址和官网地址。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/233boy/v2ray/wiki/</span><br><span class="line">https://www.v2ray.com/</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4b1f673f8611538.png" alt="v2ray官网（需要外网环境）"></p>
<h2 id="安全须知"><a href="#安全须知" class="headerlink" title="安全须知"></a>安全须知</h2><p>在正式介绍之前，请先穿好防护衣，包括但不限于</p>
<h3 id="不要用360和百度"><a href="#不要用360和百度" class="headerlink" title="不要用360和百度"></a>不要用360和百度</h3><p>包括<code>360安全卫士</code>、<code>360杀毒</code>、<code>360浏览器</code>等。因为360系和百度系的产品会自动上报IP地址，很容易造成你所用的服务器遭到封禁。</p>
<p>杀毒软件可以用Windows自带的<code>Windows Defender</code>，清理软件我自己在用<code>CCleaner</code>，至于悬浮球点一下清内存的功能，可以用<code>MemReduct</code>。当然，如果你都已经出去了，搜索引擎肯定用<code>Google</code>啦。</p>
<h3 id="不要用国内浏览器"><a href="#不要用国内浏览器" class="headerlink" title="不要用国内浏览器"></a>不要用国内浏览器</h3><p>推荐用<code>Google Chrome</code>。基本现在所有的浏览器都是基于Chrome的Chromium内核构建的，用国内浏览器会有上面提到的风险。当然用<code>Microsoft Edge</code>也行，至于<code>Internet Explorer</code>就不要用了，支持性差。</p>
<h3 id="浏览器打开「不跟踪」请求"><a href="#浏览器打开「不跟踪」请求" class="headerlink" title="浏览器打开「不跟踪」请求"></a>浏览器打开「不跟踪」请求</h3><p>以Chrome为例，打开<code>设置</code>-<code>高级</code>，在<code>隐私设置和安全性</code>一栏，打开<code>随浏览流量一起发送「不跟踪」请求</code>即可。</p>
<h3 id="更改系统语言（可选）"><a href="#更改系统语言（可选）" class="headerlink" title="更改系统语言（可选）"></a>更改系统语言（可选）</h3><p>一般来说你用哪个国家的服务器就改哪个国家的语言，据说会更加安全，但我觉得其实不改也没什么大问题:(</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4a8e85b67114671.png" alt="Chrome的设置页面"></p>
<h2 id="初级玩家——现成服务器"><a href="#初级玩家——现成服务器" class="headerlink" title="初级玩家——现成服务器"></a>初级玩家——现成服务器</h2><h3 id="免费软件"><a href="#免费软件" class="headerlink" title="免费软件"></a>免费软件</h3><p>网上有很多关于这方面的教程，都需要用户先有一个「全局代理」环境，这就变成了一个鸡生蛋蛋生鸡的问题。遇到不少坑以后，我终于找到了几款比较好用而且免费的软件。</p>
<h4 id="电脑用户"><a href="#电脑用户" class="headerlink" title="电脑用户"></a>电脑用户</h4><h5 id="无界浏览"><a href="#无界浏览" class="headerlink" title="无界浏览"></a>无界浏览</h5><p>适用平台：<code>Windows</code>、<code>Mac</code></p>
<p>这个软件用起来很简单，双击打开，等待服务器连接成功，然后你就可以上网了，速度还挺快。</p>
<p>但是这个软件背后是有组织的，奉劝大家不要被带偏了，做个默默薅羊毛的吃瓜群众就好（真诚脸</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（Windows）https://www.lanzous.com/i4eyu4b</span><br><span class="line">（Mac）https://www.lanzous.com/i4eyt1c</span><br></pre></td></tr></table></figure>

<h5 id="JJQQKK"><a href="#JJQQKK" class="headerlink" title="JJQQKK"></a>JJQQKK</h5><p>适用平台：<code>Windows</code>、<code>Mac</code></p>
<p>这是一个内置访问外网功能的Chromium浏览器，安装后从桌面右下角图标启动就可以访问了，简单易用，速度也很快。</p>
<p>它的Github主页上也有很详细的说明。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/jjqqkk/chromium</span><br></pre></td></tr></table></figure>

<h5 id="歪批嗯-Plus-Hotspot-Shield"><a href="#歪批嗯-Plus-Hotspot-Shield" class="headerlink" title="歪批嗯 Plus / Hotspot Shield"></a>歪批嗯 Plus / Hotspot Shield</h5><p>适用平台：<code>Mac</code></p>
<p>这两个软件可以在<code>美区</code>的Mac App Store找到，下载使用即可。关于美区Apple ID的注册，有空会再写一下的，后面也会讲一下找共享的美区Apple ID的方法。</p>
<p>注意，第一款软件虽然在中区Mac App Store也有上架，但是下载以后是无法使用的，必须用美区账号下载才能正常使用。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4ae968a39f51810.png" alt="JJQQKK使用说明"></p>
<h4 id="手机用户"><a href="#手机用户" class="headerlink" title="手机用户"></a>手机用户</h4><h5 id="Betternet-歪批嗯-360"><a href="#Betternet-歪批嗯-360" class="headerlink" title="Betternet / 歪批嗯 360"></a>Betternet / 歪批嗯 360</h5><p>适用平台：<code>iOS</code></p>
<p>同理，这两款软件也要在美区的App Store才能找到。我没有用过Betternet的安卓端，但它的Windows端表现并不好。</p>
<p>这两款软件在iOS的表现也很一般，只能作为应急使用。</p>
<h5 id="歪批嗯-plus"><a href="#歪批嗯-plus" class="headerlink" title="歪批嗯 plus"></a>歪批嗯 plus</h5><p>适用平台：<code>iOS</code>、<code>Android</code></p>
<p>同样，这款软件的iOS版要在美区下载，不过可以附上它的Android版下载链接。同样的，这款软件速度不算很好，但也可以应应急。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.lanzous.com/i4ez8wd</span><br></pre></td></tr></table></figure>

<h5 id="老王歪批嗯"><a href="#老王歪批嗯" class="headerlink" title="老王歪批嗯"></a>老王歪批嗯</h5><p>适用平台：<code>Android</code></p>
<p>这款软件可以在Google Play下载，当然你现在的问题就是上不去，所以还是留了个下载地址在下面。</p>
<p>其实Google Play有很多这一类的软件，去搜索一下就可以，不过应该要把Google账号的地区改为美国。关于国内手机如何安装Google Play服务，以后有空会再写一下。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.lanzous.com/i4ezbla</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4c418c8efd52105.jpg" alt="只要出去了，再找出去的路就简单了"></p>
<h3 id="配置代理"><a href="#配置代理" class="headerlink" title="配置代理"></a>配置代理</h3><p>前面说过，只要知道服务器的代理地址，就可以通过代理的方式连接外网。所以重点就在如何找这些地址以及如何配置代理。</p>
<h4 id="寻找代理节点"><a href="#寻找代理节点" class="headerlink" title="寻找代理节点"></a>寻找代理节点</h4><h5 id="通过网站"><a href="#通过网站" class="headerlink" title="通过网站"></a>通过网站</h5><p>这一类的网站只要谷歌一下<code>免费代理节点</code>就有很多，但这些网站也是需要你有外网环境的，所以用处并不是很大。但还是放两个免费代理节点的网站吧。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://free-proxy.cz/</span><br><span class="line">http://www.gatherproxy.com/zh/sockslist</span><br></pre></td></tr></table></figure>

<h5 id="通过工具"><a href="#通过工具" class="headerlink" title="通过工具"></a>通过工具</h5><p>打开下面的网站下载<code>ProxyScrape</code>，这是一个寻找免费节点的小工具。</p>
<p>打开后选择<code>Check proxies</code>，然后填写所要求的代理服务器的<code>ping值</code>，ping值越大，表明延迟越大。一般来说，公用的服务器ping值都会在100ms以上，因此这里可以取400-500左右。</p>
<p>接着是填写检查<code>代理服务器的数量</code>，然后会提示选择<code>代理服务器的协议类型</code>。一般而言HTTPS是最安全的，这里可以根据需求自行选择。</p>
<p>然后选择<code>Check from ProxyScrape.com</code>，工具就会开始筛选代理，并把可用的代理用绿色表示出来。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://proxyscrape.com/proxy-checker</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4aece3e10759708.png" alt="ProxyScrape界面"></p>
<h4 id="配置网络代理"><a href="#配置网络代理" class="headerlink" title="配置网络代理"></a>配置网络代理</h4><p>获得代理节点后，我们需要配置代理，让网络通过代理上网。如果只是部分想让部分软件设置代理，则可以使用这些软件自带的代理功能。如果想实现系统代理，则需要调整系统设置。</p>
<h5 id="设置软件代理"><a href="#设置软件代理" class="headerlink" title="设置软件代理"></a>设置软件代理</h5><p>以网易云音乐为例，点击<code>设置</code>-<code>工具</code>，在代理选项卡下有三个选项，若选择使用IE代理设置，则需要提前设置好IE的代理。如果选择<code>自定义代理</code>，则在下拉菜单中选择代理类型，并输入服务器与端口（比如说所得结果为<code>1.2.3.4:5</code>，则服务器地址为<code>1.2.3.4</code>，端口为<code>5</code>），保存即可。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4af122f9b965539.png" alt="网易云音乐配置代理"></p>
<h5 id="设置IE代理"><a href="#设置IE代理" class="headerlink" title="设置IE代理"></a>设置IE代理</h5><p>打开IE，点击右上方<code>设置</code>-<code>Internet选项</code>，选择<code>连接</code>-<code>局域网设置</code>，勾选<code>为LAN使用代理服务器</code>，填好地址和端口，并勾选<code>对于本机地址不使用代理服务器</code>，保存并退出。</p>
<h5 id="设置全局代理"><a href="#设置全局代理" class="headerlink" title="设置全局代理"></a>设置全局代理</h5><p>打开系统的<code>设置</code>-<code>网络和Internet</code>-<code>代理</code>，选择<code>使用代理服务器</code>，填好地址和端口，并保存。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4b3d21eac346596.png" alt="设置IE代理"></p>
<p><img src="https://i.loli.net/2019/06/03/5cf4d8ec7326a67834.png" alt="设置系统代理"></p>
<h5 id="设置浏览器代理"><a href="#设置浏览器代理" class="headerlink" title="设置浏览器代理"></a>设置浏览器代理</h5><p>大部分如Chrome、Firefox等浏览器，都可以通过安装插件的方式实现为浏览器设置代理。以Chrome为例，打开<code>Chrome网上应用店</code>，搜索<code>SwitchyOmega</code>并安装（需要外网环境）。在百度直接搜索也不是不行，但是这样一般会安装不成功。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://chrome.google.com/webstore/category/extensions?hl=zh-CN</span><br></pre></td></tr></table></figure>

<p>下载完成后点击插件的<code>选项</code>，进入配置页面。点击情景模式的<code>proxy</code>，填写代理协议、代理服务器和端口。然后点击<code>auto switch</code>，切换规则只留<code>proxy</code>，默认情景模式设为<code>直接连接</code>，在导入在线规则列表下，点击<code>添加规则列表</code>并填入下面网址，点击<code>立即更新情景模式</code>，保存后退出。此时可以禁用系统设置中的网络代理。</p>
<p>点击插件，选择<code>auto switch</code>或<code>proxy</code>，就可以用浏览器访问外网了。其中proxy相当于<code>全局模式</code>，auto switch相当于<code>PAC模式</code>。至于全局模式和PAC模式，会在后面有解释。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4d9630f04083920.png" alt></p>
<p><img src="https://i.loli.net/2019/06/03/5cf4b1046484215529.png" alt="SwitchyOmega配置"></p>
<h3 id="收费渠道"><a href="#收费渠道" class="headerlink" title="收费渠道"></a>收费渠道</h3><p>收费的那可就太多了，主要是分成以下两类。</p>
<h4 id="收费软件"><a href="#收费软件" class="headerlink" title="收费软件"></a>收费软件</h4><p>只要写着<code>加速器</code>的一般都是要收费的，收费标准我没有了解，有些按照流量来计费，有些按照时长。电脑端的付费软件有很多，可以在Youtube上查到。</p>
<p>手机用户也是一样的，只要把地区切换到<code>美国</code>，就能在App Store或者Google Play找到很多这一类的软件。</p>
<h4 id="收费机场"><a href="#收费机场" class="headerlink" title="收费机场"></a>收费机场</h4><p>也不是说机场就一定收费，我也用过一些免费的机场，但也只用了一个月。机场基本都差不多，会有很详细的教程，Youtube上有很多推荐。</p>
<h2 id="进阶玩家——自建服务器"><a href="#进阶玩家——自建服务器" class="headerlink" title="进阶玩家——自建服务器"></a>进阶玩家——自建服务器</h2><h3 id="自己做「机场主」"><a href="#自己做「机场主」" class="headerlink" title="自己做「机场主」"></a>自己做「机场主」</h3><p>前面说过机场是提供国外服务器的，那能不能自己找一台国外的服务器呢？答案是肯定的，而且一点也不复杂。</p>
<p>自己找一台国外的服务器，速度和安全性会有保证，而且价格也不一定贵。访问外网最重要的当然是安全，前面的免费软件使用的是别人提供的服务器，有可能会留有后门，取得你的个人资料，终究不是最好的方案。</p>
<h3 id="为什么用GCP"><a href="#为什么用GCP" class="headerlink" title="为什么用GCP"></a>为什么用GCP</h3><p>现在一般的主流服务器供应商有<code>谷歌云（Google Cloud Platform，GCP）</code>、<code>搬瓦工（BandwagonHost）</code>、<code>Vultr</code>等。搬瓦工和Vultr我没有用过，它是要付费的，跟很多主流服务器提供商一样。如果想找这方面的服务器，还可以考虑<code>阿里云</code>等等，在Youtube上也会有关于这方面的视频。</p>
<p>至于GCP，本来也是要付费的，但是现在它有<code>300美金试用一年</code>的活动，搭一个服务器，就足够十几个人爽一年了。而且，根据Youtube上的教程，一年有效期过后，通过简单的操作，又可以把300美金重新拿到手。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4b2ca8f02f10495.png" alt="这么大的羊毛为什么不薅"></p>
<h3 id="申请GCP"><a href="#申请GCP" class="headerlink" title="申请GCP"></a>申请GCP</h3><h4 id="准备一张Visa-万事达信用卡"><a href="#准备一张Visa-万事达信用卡" class="headerlink" title="准备一张Visa / 万事达信用卡"></a>准备一张Visa / 万事达信用卡</h4><p>这是注册GCP的先决条件，因为注册需要你绑定一张信用卡以验证，但以后使用的时候，Google是不会自动从这张卡扣费的。有实体卡是最好的，但实体卡也不一定全部都可以，可以在Google或者Youtube搜索<code>谷歌云注册</code>看下最新的教程。</p>
<p>我当时是注册了一张虚拟万事达信用卡通过了认证，但我不知道现在的认证条件有没有改变，想尝试的可以试一下，教程链接在下方。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.wn789.com/14908.html</span><br></pre></td></tr></table></figure>

<h4 id="生成境外地址"><a href="#生成境外地址" class="headerlink" title="生成境外地址"></a>生成境外地址</h4><p>谷歌云现在国家选项已经不能选中国了，建议选<code>香港</code>或者<code>美国</code>，我选择的是美国。注册时需要填写地址，百度一下<code>美国地址生成器</code>就能得到了。</p>
<h4 id="准备外网环境"><a href="#准备外网环境" class="headerlink" title="准备外网环境"></a>准备外网环境</h4><p>GCP的注册和使用需要外网环境，所以要先用前面提到的软件应个急。搭建完成后，就可以用自己搭建的服务器上网啦。</p>
<h4 id="进入注册"><a href="#进入注册" class="headerlink" title="进入注册"></a>进入注册</h4><p>准备好上面的内容后，打开下方网页并完成注册，正常情况下Google会从你的信用卡扣费1美元，如果扣费成功，证明账号已经注册成功了。我注册时没有遇到问题，如果遇到问题的话，可以谷歌一下解决方案。</p>
<p>点击左上角的菜单，选择<code>结算</code>，可以看到剩余赠金和剩余试用日期。如果选择的地区是香港，会显示有2000+的赠金，那是因为货币单位是港元，不是美元，不必惊慌。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cloud.google.com/?hl=zh-cn</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4b3760f2d362094.png" alt="GCP注册成功后就会转到这个页面"></p>
<h3 id="用GCP搭建服务器"><a href="#用GCP搭建服务器" class="headerlink" title="用GCP搭建服务器"></a>用GCP搭建服务器</h3><h4 id="创建防火墙规则"><a href="#创建防火墙规则" class="headerlink" title="创建防火墙规则"></a>创建防火墙规则</h4><p>点击菜单中的<code>VPC网络</code>-<code>防火墙规则</code>，进入防火墙规则页面后，点击<code>创建防火墙规则</code>，进入防火墙规则创建界面。</p>
<p>名称改为<code>entrance</code>（其他名称也可以），优先级设为<code>1</code>，流量方向为<code>入站</code>，对匹配项执行的操作选择<code>允许</code>，目标选择<code>网络中的所有实例</code>，来源IP地址范围填写<code>0.0.0.0/0</code>，协议和端口选<code>全部允许</code>，点击<code>创建</code>即可。</p>
<p>同理，再创建一个防火墙实例，名称改为<code>exit</code>，流量方向为<code>出站</code>，其余与上面的一致，保存。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4b3f15afde47834.png" alt="防火墙规则的创建"></p>
<h4 id="创建VM实例"><a href="#创建VM实例" class="headerlink" title="创建VM实例"></a>创建VM实例</h4><p>点击菜单中的<code>Compute Engine</code>-<code>VM实例</code>，点击<code>创建</code>，进入VM实例创建页面。</p>
<p>名称任意，区域建议选择<code>asia-east2（香港）</code>或<code>asia-east1（台湾）</code>，地区任意，机器类型选择<code>微型</code>（几个人用足够了，如果你要给很多人用，就挑大一点的），防火墙勾选<code>允许HTTP流量</code>、<code>允许HTTPS流量</code>。</p>
<p>下面的标签页切换到<code>网络</code>一栏，在<code>网络标记</code>一栏填入刚才创建好的两个防火墙规则的名字，点击最下方的<code>创建</code>，完成VM实例创建。</p>
<p>创建完成后会出来一个内部IP和一个外部IP，打开命令提示符（Win+R后cmd回车），输入<code>ping 外部IP</code>（比如<code>ping 35.XXX.XXX.XXX</code>），查看ping值。</p>
<p>如果ping值过大，则再创建一个新的实例（注意不要把原来的实例删除，不然会分配到同一台服务器），直到得到一台ping值小的服务器（一般100ms以内，数字越小越好），再把其它实例删除。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4b5bf3445792268.png" alt="VM实例的创建"></p>
<h4 id="在VM实例上搭建协议"><a href="#在VM实例上搭建协议" class="headerlink" title="在VM实例上搭建协议"></a>在VM实例上搭建协议</h4><p>这里的协议就是前面所提到的<code>v2ray</code>、<code>shadowsocks（SS）</code>、<code>shadowsocksR（SSR）</code>、<code>wireguard</code>、<code>brook</code>、<code>outline</code>等，一般选用v2ray或SS，下面以v2ray做演示。</p>
<p>点击VM实例上的<code>SSH</code>按钮，等待命令行窗口出现。在命令行中输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br><span class="line">bash &lt;(curl -s -L https://git.io/v2ray.sh)</span><br></pre></td></tr></table></figure>

<p>以获取管理员权限，并执行v2ray一键安装脚本。按照流程一步步回车，还可以选择一同搭建SS。</p>
<p>得到v2ray配置信息后复制，并输入<code>v2ray ssqr</code>生成二维码，便于以后使用和分享。如果二维码无法生成，那么客户端使用的时候就要手动输入服务器的配置。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4b6910657561452.png" alt="输入这两行代码，就可以自动配置v2ray环境"></p>
<h4 id="v2ray客户端的使用"><a href="#v2ray客户端的使用" class="headerlink" title="v2ray客户端的使用"></a>v2ray客户端的使用</h4><p>至此v2ray已经搭建完成，只需要下载对应的客户端即可使用。</p>
<h5 id="Windows用户"><a href="#Windows用户" class="headerlink" title="Windows用户"></a>Windows用户</h5><p>下载v2rayN-Core.zip，解压并打开<code>v2rayN.exe</code>。点击服务器，选择<code>扫描屏幕上的二维码</code>，客户端会自动扫描刚才生成的二维码并添加配置信息。如果无法生成二维码，则点击<code>添加Vmess服务器</code>，手动输入刚才保存的配置信息。右键点击新增的服务器，选择<code>设为活动服务器</code>。然后在v2ray的托盘图标点击右键，勾选<code>启用http代理</code>，并在http代理模式中选择<code>PAC模式</code>，即可上网。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/2dust/v2rayN/releases/</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4db2f34efa63321.png" alt></p>
<p><img src="https://i.loli.net/2019/06/03/5cf4b6d986e7998661.png" alt="v2rayN的设置"></p>
<h5 id="Mac用户"><a href="#Mac用户" class="headerlink" title="Mac用户"></a>Mac用户</h5><p>与Windows客户端的配置类似。下载zip包并解压，将<code>V2RayX.app</code>复制到应用程序文件夹后打开，点击菜单中的<code>Configure</code>，输入刚才保存的服务器配置信息。然后在<code>Servers</code>中选择刚才新建的服务器，确保v2ray code处于<code>load</code>状态，并勾选<code>PAC Mode</code>，配置完成。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/insisttech/v2rayX-copy/releases</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4dc208516b19277.png" alt="V2RayX的配置"></p>
<h5 id="Android用户"><a href="#Android用户" class="headerlink" title="Android用户"></a>Android用户</h5><p>下载<code>app-universal-release.apk</code>，安装到手机并打开。点击上方<code>+</code>号并选择<code>从二维码导入配置</code>，扫描前面生成的二维码，这样服务器配置就添加进来了。同理，如果二维码无法生成，则点击<code>手动输入</code>。</p>
<p>然后点击左上角的菜单，选择设置，在路由模式中选择<code>绕过中国大陆</code>。回到主页面，点击右下角的启动按钮，允许连接。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/2dust/v2rayNG/releases</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4dd0f9a13e95368.jpg" alt="V2rayNG的配置"></p>
<h5 id="iOS用户"><a href="#iOS用户" class="headerlink" title="iOS用户"></a>iOS用户</h5><p>iOS端没有官方的v2ray客户端，需要下载第三方的软件。最好用的第三方客户端是Kitsunebi，同样要用美区的Apple ID，而且需要付费。最方便的下载方法是使用共享账号，打开<code>ios.scdxc.app</code>，搜索<code>Kitsunebi</code>，根据流程完成下载就可以了。</p>
<p>下面以Kitsunebi为例说明iOS端的配置方法。打开Kitsunebi，选择下方的<code>服务器</code>，点击右上方<code>+</code>号并选择<code>扫二维码</code>，扫描刚才生成的二维码，即可导入服务器配置。然后把操作模式改到<code>Rule</code>，传出代理选择刚才添加的服务器。</p>
<p>切换到<code>高级</code>选项卡，点击<code>规则集</code>并在弹出的页面中点击Default右边的按钮，将URL改为下面的网址，并点击<code>存储</code>。再切换到状态标签卡，点击开关，允许连接，完成配置。以后使用时，直接打开软件并打开开关就可以了。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://raw.githubusercontent.com/ConnersHua/Profiles/master/Kitsunebi/Pro.conf</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/06/03/5cf4c8b4b699e61319.jpg" alt="Kitsunebi的配置"></p>
<h4 id="Linux用户使用"><a href="#Linux用户使用" class="headerlink" title="Linux用户使用"></a>Linux用户使用</h4><p>前面提到的软件涵盖了Windows、Mac、Android和iOS，唯独没有包括Linux。因为Linux系统对命令行的依赖，加上Linux的软件生态没有Windows来的广阔，导致没办法找到一个比较好的图形化客户端。</p>
<p>不过能玩Linux的一般都是肯折腾的人，区区命令行不在话下:(</p>
<h5 id="配置代理-1"><a href="#配置代理-1" class="headerlink" title="配置代理"></a>配置代理</h5><p>虽然Linux找不到一个好的客户端，但是Linux还是可以通过前面所说的配置代理的方式达到我们的目的。配置方法是类似的，对于配置系统代理，在Ubuntu中位于<code>设置</code>-<code>网络</code>-<code>网络代理</code>-<code>手动配置代理</code>，其它Linux系统也类似。对于其它代理的配置则基本相同。</p>
<h5 id="连接到已搭建v2ray的服务器"><a href="#连接到已搭建v2ray的服务器" class="headerlink" title="连接到已搭建v2ray的服务器"></a>连接到已搭建v2ray的服务器</h5><h6 id="安装v2ray"><a href="#安装v2ray" class="headerlink" title="安装v2ray"></a>安装v2ray</h6><p>进入下面网站（需要外网环境，可在Windows下进行），点击<code>v2ray-linux-64.zip</code>进行下载，解压后放于<code>/tmp/v2ray</code>，并改名为<code>v2ray.zip</code>。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/v2ray/v2ray-core/releases</span><br></pre></td></tr></table></figure>

<p>打开终端并输入命令，下载好的脚本会放于终端工作路径（默认为主文件夹，即<code>/home/用户名</code>）。若go.sh无法下载，可使用文末附有的代码。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http<span class="variable">s:</span>//install.direct/<span class="keyword">go</span>.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure>

<p>用文本编辑器打开下载好的go.sh，找到<code>downloadV2Ray()</code>函数，删除函数内所有代码并<code>return 0</code>，如下所示</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">downloadV2Ray</span></span>()&#123;</span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修改完成后在终端输入命令，等待v2ray安装完成。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./<span class="keyword">go</span>.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure>

<p>安装完成后输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nautilus</span><br></pre></td></tr></table></figure>

<p>输入密码时，命令行是不会有提示字符的，照输就可以了。打开文件管理器后，转到<code>/etc/v2ray/config.json</code>，打开并将内容用下面的代码覆盖。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"log"</span>: &#123;</span><br><span class="line">    <span class="string">"access"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"error"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"loglevel"</span>: <span class="string">"warning"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"inbound"</span>: &#123;</span><br><span class="line">    <span class="string">"port"</span>: 1080,</span><br><span class="line">    <span class="string">"listen"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line"></span><br><span class="line">// SOCKS 地址及代理端口，在浏览器中需配置代理并指向这个端口，此处使用127.0.0.1:1080</span><br><span class="line"></span><br><span class="line">    <span class="string">"protocol"</span>: <span class="string">"socks"</span>,</span><br><span class="line">    <span class="string">"domainOverride"</span>: [</span><br><span class="line">      <span class="string">"tls"</span>,</span><br><span class="line">      <span class="string">"http"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"settings"</span>: &#123;</span><br><span class="line">      <span class="string">"auth"</span>: <span class="string">"noauth"</span>,</span><br><span class="line">      <span class="string">"udp"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">"ip"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">      <span class="string">"clients"</span>: null</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"streamSettings"</span>: null</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"outbound"</span>: &#123;</span><br><span class="line">    <span class="string">"tag"</span>: <span class="string">"agentout"</span>,</span><br><span class="line">    <span class="string">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="string">"settings"</span>: &#123;</span><br><span class="line">      <span class="string">"vnext"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"address"</span>: <span class="string">"server"</span>, </span><br><span class="line">          <span class="string">"port"</span>: 10086,  </span><br><span class="line"></span><br><span class="line">// 服务器地址及端口，需修改为自己的服务器 IP 或域名</span><br><span class="line"></span><br><span class="line">          <span class="string">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>, </span><br><span class="line">              <span class="string">"alterId"</span>: 0,</span><br><span class="line">              <span class="string">"email"</span>: <span class="string">"t@t.tt"</span>,</span><br><span class="line">              <span class="string">"security"</span>: <span class="string">"aes-128-gcm"</span></span><br><span class="line"></span><br><span class="line">// 此处配置应与服务器配置的信息一致</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"servers"</span>: null</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="string">"network"</span>: <span class="string">"tcp"</span>,</span><br><span class="line">      <span class="string">"security"</span>: <span class="string">""</span>,</span><br><span class="line">      <span class="string">"tlsSettings"</span>: null,</span><br><span class="line">      <span class="string">"tcpSettings"</span>: null,</span><br><span class="line">      <span class="string">"kcpSettings"</span>: null,</span><br><span class="line">      <span class="string">"wsSettings"</span>: null,</span><br><span class="line">      <span class="string">"httpSettings"</span>: null</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"mux"</span>: &#123;</span><br><span class="line">      <span class="string">"enabled"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"inboundDetour"</span>: null,</span><br><span class="line">  <span class="string">"outboundDetour"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"protocol"</span>: <span class="string">"freedom"</span>,</span><br><span class="line">      <span class="string">"settings"</span>: &#123;</span><br><span class="line">        <span class="string">"response"</span>: null</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">"tag"</span>: <span class="string">"direct"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"protocol"</span>: <span class="string">"blackhole"</span>,</span><br><span class="line">      <span class="string">"settings"</span>: &#123;</span><br><span class="line">        <span class="string">"response"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"http"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">"tag"</span>: <span class="string">"blockout"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"dns"</span>: &#123;</span><br><span class="line">    <span class="string">"servers"</span>: [</span><br><span class="line">      <span class="string">"8.8.8.8"</span>,</span><br><span class="line">      <span class="string">"8.8.4.4"</span>,</span><br><span class="line">      <span class="string">"localhost"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"routing"</span>: &#123;</span><br><span class="line">    <span class="string">"strategy"</span>: <span class="string">"rules"</span>,</span><br><span class="line">    <span class="string">"settings"</span>: &#123;</span><br><span class="line">      <span class="string">"domainStrategy"</span>: <span class="string">"IPIfNonMatch"</span>,</span><br><span class="line">      <span class="string">"rules"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"field"</span>,</span><br><span class="line">          <span class="string">"port"</span>: null,</span><br><span class="line">          <span class="string">"outboundTag"</span>: <span class="string">"direct"</span>,</span><br><span class="line">          <span class="string">"ip"</span>: [</span><br><span class="line">            <span class="string">"0.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"10.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"100.64.0.0/10"</span>,</span><br><span class="line">            <span class="string">"127.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"169.254.0.0/16"</span>,</span><br><span class="line">            <span class="string">"172.16.0.0/12"</span>,</span><br><span class="line">            <span class="string">"192.0.0.0/24"</span>,</span><br><span class="line">            <span class="string">"192.0.2.0/24"</span>,</span><br><span class="line">            <span class="string">"192.168.0.0/16"</span>,</span><br><span class="line">            <span class="string">"198.18.0.0/15"</span>,</span><br><span class="line">            <span class="string">"198.51.100.0/24"</span>,</span><br><span class="line">            <span class="string">"203.0.113.0/24"</span>,</span><br><span class="line">            <span class="string">"::1/128"</span>,</span><br><span class="line">            <span class="string">"fc00::/7"</span>,</span><br><span class="line">            <span class="string">"fe80::/10"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="string">"domain"</span>: null</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>保存后在终端<code>Ctrl+C</code>并输入下面的命令，使v2ray开机自启，并启动v2ray查看状态。如果显示绿色，证明v2ray已成功运行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> v2ray</span><br><span class="line">sudo systemctl start v2ray</span><br><span class="line">sudo systemctl status v2ray</span><br></pre></td></tr></table></figure>

<h6 id="使用v2ray"><a href="#使用v2ray" class="headerlink" title="使用v2ray"></a>使用v2ray</h6><p>这时候v2ray已经把你的服务器映射到本地代理127.0.0.1:1080了，按照前面所说的配置系统代理的方式即可使用，类型选择<code>Socks5</code>，服务器地址为<code>127.0.0.1</code>，端口为<code>1080</code>。配置系统代理后就可以配置浏览器代理，以后使用时，可以只打开浏览器代理，而关闭系统代理。</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="如何寻找美区Apple-ID、下载美区付费软件"><a href="#如何寻找美区Apple-ID、下载美区付费软件" class="headerlink" title="如何寻找美区Apple ID、下载美区付费软件"></a>如何寻找美区Apple ID、下载美区付费软件</h3><p>推荐几个分享美区Apple ID的公众号，</p>
<p><code>SCDxC</code>、<code>大灰hurbai</code>、<code>康庄大道CK</code>、<code>GameToom</code>、<code>SMG果粉ID</code>、<code>叶子游戏</code></p>
<p>我个人最喜欢SCDxC，已购应用多，账号也多，还有网页版<code>ios.scdxc.app</code>，查找应用时非常方便，也有上面所提到的v2ray客户端的下载。</p>
<p>这些共享账号的使用也很简单，首先你要看哪个共享账号有你想要的应用并获得密码，然后把自己的Apple ID退出并登录公众号提供的账号，就可以下载了。</p>
<h3 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><h4 id="其它v2ray-SS的iOS客户端"><a href="#其它v2ray-SS的iOS客户端" class="headerlink" title="其它v2ray / SS的iOS客户端"></a>其它v2ray / SS的iOS客户端</h4><p>除iOS和Linux外，这两种协议在其他平台都是有官方客户端的。关于SS的搭建也有类似的一键安装脚本，不过我还是建议，如果想用SS的话，在v2ray配置的时候顺便搭建好就可以了，毕竟v2ray相比SS还是有优势的。关于SS的官方客户端，谷歌一下<code>SS客户端</code>就能找到了。</p>
<p>Android上的第三方客户端大多都是免费的，iOS上的第三方客户端则大多都要付费。然而iOS只能用第三方客户端……</p>
<p>比较常见的第三方客户端有</p>
<p><code>Kitsunebi</code>，最常用于v2ray（即Vmess协议），也可以用于SS。</p>
<p><code>Shadowrocket（小火箭）</code>，最常用于SS，支持包括SSR、Vmess、Socks5、HTTP(S)、Subscribe在内的很多协议，功能也很强大，使用比较简单，是多数机场选择的客户端。</p>
<p><code>Quantumult</code>，界面设计很美观，支持SS、SSR、Subscribe、Vmess等协议。然而对新手不是很友好，我到现在都没搞懂怎么用。</p>
<p>上面这些最常用的，尤其以前两个为最，一个用于v2ray，一个用于SS。其余还有<code>Surge</code>、<code>Pepi</code>等。至于下载方法……前面不是说了么（</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4d31d02ae569092.jpg" alt="左中右分别为Kitsunebi、Shadowrocket、Quantumult"></p>
<h4 id="全局-直连-规则模式"><a href="#全局-直连-规则模式" class="headerlink" title="全局 / 直连 / 规则模式"></a>全局 / 直连 / 规则模式</h4><p><code>全局模式（Global）</code>，就是所有的流量都走服务器，包括访问国内的网站。这样会使服务器所耗流量增加，而且访问国内网站时，由于数据包绕了远路，速度也会慢一点。但有些情况必须打开全局模式。</p>
<p><code>直连模式（Direct）</code>，就是完全不走服务器，等于没有连接外网。</p>
<p><code>规则模式（Rule）</code>，我认为跟电脑的<code>PAC模式</code>是一样的，通过设定规则，让某些网站走服务器，另一些则直接连接。不同的是，手机上的规则模式需要指定规则文件，而电脑的PAC模式一般会自动生成规则文件，并根据你访问的网站对规则进行更新。</p>
<p>前面配置iOS客户端的时候，所替换的URL其实就是一个规则文件。下面附上规则文件的Github地址，如果使用的是其它的客户端，可以在这些网站找到对应的规则文件。</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//github.com/ConnersHua/Profiles/blob/master/README.md</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//github.com/allenking1028/ss/issues/10</span></span><br></pre></td></tr></table></figure>

<h4 id="VPS"><a href="#VPS" class="headerlink" title="VPS"></a>VPS</h4><p>可能有人会听说过VPS，但是不知道VPS是什么，跟歪批嗯有什么关系。</p>
<p>其实<code>VPS（Virtual Private Server，虚拟专用服务器）</code>可以理解为安装到电脑上的虚拟机。一台电脑可以安装很多台虚拟机，而这些虚拟机都是相互独立的，可以用作不同的事情。也就是说，前面所提到的那些协议，都是安装在VPS上的，包括歪批嗯。</p>
<p>当然，VPS的作用不止是搭建服务器。普通电脑可以完成的事情，VPS也可以完成，包括搭建网站等。</p>
<p><img src="https://i.loli.net/2019/06/03/5cf4d466e79ab87441.png" alt="VPS的基本原理"></p>
<h3 id="一点忠告"><a href="#一点忠告" class="headerlink" title="一点忠告"></a>一点忠告</h3><p>学习诚可贵，安全价更高。若为自由故，两者也不可抛。</p>
<h3 id="v2ray配置脚本go-sh"><a href="#v2ray配置脚本go-sh" class="headerlink" title="v2ray配置脚本go.sh"></a>v2ray配置脚本go.sh</h3><p>复制以下代码到文本编辑器并另存为go.sh，放在工作目录即可使用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This file is accessible as https://install.direct/go.sh</span></span><br><span class="line"><span class="comment"># Original source is located at github.com/v2ray/v2ray-core/release/install-release.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If not specify, default meaning of return value:</span></span><br><span class="line"><span class="comment"># 0: Success</span></span><br><span class="line"><span class="comment"># 1: System error</span></span><br><span class="line"><span class="comment"># 2: Application error</span></span><br><span class="line"><span class="comment"># 3: Network error</span></span><br><span class="line"></span><br><span class="line">CUR_VER=<span class="string">""</span></span><br><span class="line">NEW_VER=<span class="string">""</span></span><br><span class="line">ARCH=<span class="string">""</span></span><br><span class="line">VDIS=<span class="string">"64"</span></span><br><span class="line">ZIPFILE=<span class="string">"/tmp/v2ray/v2ray.zip"</span></span><br><span class="line">V2RAY_RUNNING=0</span><br><span class="line">VSRC_ROOT=<span class="string">"/tmp/v2ray"</span></span><br><span class="line">EXTRACT_ONLY=0</span><br><span class="line">ERROR_IF_UPTODATE=0</span><br><span class="line">DIST_SRC=<span class="string">"github"</span></span><br><span class="line"></span><br><span class="line">CMD_INSTALL=<span class="string">""</span></span><br><span class="line">CMD_UPDATE=<span class="string">""</span></span><br><span class="line">SOFTWARE_UPDATED=0</span><br><span class="line"></span><br><span class="line">SYSTEMCTL_CMD=$(<span class="built_in">command</span> -v systemctl 2&gt;/dev/null)</span><br><span class="line">SERVICE_CMD=$(<span class="built_in">command</span> -v service 2&gt;/dev/null)</span><br><span class="line"></span><br><span class="line">CHECK=<span class="string">""</span></span><br><span class="line">FORCE=<span class="string">""</span></span><br><span class="line">HELP=<span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#######color code########</span></span><br><span class="line">RED=<span class="string">"31m"</span>      <span class="comment"># Error message</span></span><br><span class="line">GREEN=<span class="string">"32m"</span>    <span class="comment"># Success message</span></span><br><span class="line">YELLOW=<span class="string">"33m"</span>   <span class="comment"># Warning message</span></span><br><span class="line">BLUE=<span class="string">"36m"</span>     <span class="comment"># Info message</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#########################</span></span><br><span class="line"><span class="keyword">while</span> [[ <span class="variable">$#</span> &gt; 0 ]];<span class="keyword">do</span></span><br><span class="line">    key=<span class="string">"<span class="variable">$1</span>"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$key</span> <span class="keyword">in</span></span><br><span class="line">        -p|--proxy)</span><br><span class="line">        PROXY=<span class="string">"-x <span class="variable">$&#123;2&#125;</span>"</span></span><br><span class="line">        <span class="built_in">shift</span> <span class="comment"># past argument</span></span><br><span class="line">        ;;</span><br><span class="line">        -h|--<span class="built_in">help</span>)</span><br><span class="line">        HELP=<span class="string">"1"</span></span><br><span class="line">        ;;</span><br><span class="line">        -f|--force)</span><br><span class="line">        FORCE=<span class="string">"1"</span></span><br><span class="line">        ;;</span><br><span class="line">        -c|--check)</span><br><span class="line">        CHECK=<span class="string">"1"</span></span><br><span class="line">        ;;</span><br><span class="line">        --remove)</span><br><span class="line">        REMOVE=<span class="string">"1"</span></span><br><span class="line">        ;;</span><br><span class="line">        --version)</span><br><span class="line">        VERSION=<span class="string">"<span class="variable">$2</span>"</span></span><br><span class="line">        <span class="built_in">shift</span></span><br><span class="line">        ;;</span><br><span class="line">        --extract)</span><br><span class="line">        VSRC_ROOT=<span class="string">"<span class="variable">$2</span>"</span></span><br><span class="line">        <span class="built_in">shift</span></span><br><span class="line">        ;;</span><br><span class="line">        --extractonly)</span><br><span class="line">        EXTRACT_ONLY=<span class="string">"1"</span></span><br><span class="line">        ;;</span><br><span class="line">        -l|--<span class="built_in">local</span>)</span><br><span class="line">        LOCAL=<span class="string">"<span class="variable">$2</span>"</span></span><br><span class="line">        LOCAL_INSTALL=<span class="string">"1"</span></span><br><span class="line">        <span class="built_in">shift</span></span><br><span class="line">        ;;</span><br><span class="line">        --<span class="built_in">source</span>)</span><br><span class="line">        DIST_SRC=<span class="string">"<span class="variable">$2</span>"</span></span><br><span class="line">        <span class="built_in">shift</span></span><br><span class="line">        ;;</span><br><span class="line">        --errifuptodate)</span><br><span class="line">        ERROR_IF_UPTODATE=<span class="string">"1"</span></span><br><span class="line">        ;;</span><br><span class="line">        *)</span><br><span class="line">                <span class="comment"># unknown option</span></span><br><span class="line">        ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line">    <span class="built_in">shift</span> <span class="comment"># past argument or value</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###############################</span></span><br><span class="line"><span class="function"><span class="title">colorEcho</span></span>()&#123;</span><br><span class="line">    COLOR=<span class="variable">$1</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[<span class="variable">$&#123;COLOR&#125;</span><span class="variable">$&#123;@:2&#125;</span>\033[0m"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">sysArch</span></span>()&#123;</span><br><span class="line">    ARCH=$(uname -m)</span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == <span class="string">"i686"</span> ]] || [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == <span class="string">"i386"</span> ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"32"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == *<span class="string">"armv7"</span>* ]] || [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == <span class="string">"armv6l"</span> ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"arm"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == *<span class="string">"armv8"</span>* ]] || [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == <span class="string">"aarch64"</span> ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"arm64"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == *<span class="string">"mips64le"</span>* ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"mips64le"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == *<span class="string">"mips64"</span>* ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"mips64"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == *<span class="string">"mipsle"</span>* ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"mipsle"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == *<span class="string">"mips"</span>* ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"mips"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == *<span class="string">"s390x"</span>* ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"s390x"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == <span class="string">"ppc64le"</span> ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"ppc64le"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$ARCH</span>"</span> == <span class="string">"ppc64"</span> ]]; <span class="keyword">then</span></span><br><span class="line">        VDIS=<span class="string">"ppc64"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">downloadV2Ray</span></span>()&#123;</span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">installSoftware</span></span>()&#123;</span><br><span class="line">    COMPONENT=<span class="variable">$1</span></span><br><span class="line">    <span class="keyword">if</span> [[ -n `<span class="built_in">command</span> -v <span class="variable">$COMPONENT</span>` ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">return</span> 0</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    getPMT</span><br><span class="line">    <span class="keyword">if</span> [[ $? -eq 1 ]]; <span class="keyword">then</span></span><br><span class="line">        colorEcho <span class="variable">$&#123;RED&#125;</span> <span class="string">"The system package manager tool isn't APT or YUM, please install <span class="variable">$&#123;COMPONENT&#125;</span> manually."</span></span><br><span class="line">        <span class="built_in">return</span> 1 </span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="variable">$SOFTWARE_UPDATED</span> -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line">        colorEcho <span class="variable">$&#123;BLUE&#125;</span> <span class="string">"Updating software repo"</span></span><br><span class="line">        <span class="variable">$CMD_UPDATE</span>      </span><br><span class="line">        SOFTWARE_UPDATED=1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    colorEcho <span class="variable">$&#123;BLUE&#125;</span> <span class="string">"Installing <span class="variable">$&#123;COMPONENT&#125;</span>"</span></span><br><span class="line">    <span class="variable">$CMD_INSTALL</span> <span class="variable">$COMPONENT</span></span><br><span class="line">    <span class="keyword">if</span> [[ $? -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">        colorEcho <span class="variable">$&#123;RED&#125;</span> <span class="string">"Failed to install <span class="variable">$&#123;COMPONENT&#125;</span>. Please install it manually."</span></span><br><span class="line">        <span class="built_in">return</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># return 1: not apt, yum, or zypper</span></span><br><span class="line"><span class="function"><span class="title">getPMT</span></span>()&#123;</span><br><span class="line">    <span class="keyword">if</span> [[ -n `<span class="built_in">command</span> -v apt-get` ]];<span class="keyword">then</span></span><br><span class="line">        CMD_INSTALL=<span class="string">"apt-get -y -qq install"</span></span><br><span class="line">        CMD_UPDATE=<span class="string">"apt-get -qq update"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ -n `<span class="built_in">command</span> -v yum` ]]; <span class="keyword">then</span></span><br><span class="line">        CMD_INSTALL=<span class="string">"yum -y -q install"</span></span><br><span class="line">        CMD_UPDATE=<span class="string">"yum -q makecache"</span></span><br><span class="line">    <span class="keyword">elif</span> [[ -n `<span class="built_in">command</span> -v zypper` ]]; <span class="keyword">then</span></span><br><span class="line">        CMD_INSTALL=<span class="string">"zypper -y install"</span></span><br><span class="line">        CMD_UPDATE=<span class="string">"zypper ref"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">return</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">extract</span></span>()&#123;</span><br><span class="line">    colorEcho <span class="variable">$&#123;BLUE&#125;</span><span class="string">"Extracting V2Ray package to /tmp/v2ray."</span></span><br><span class="line">    mkdir -p /tmp/v2ray</span><br><span class="line">    unzip <span class="variable">$1</span> -d <span class="variable">$&#123;VSRC_ROOT&#125;</span></span><br><span class="line">    <span class="keyword">if</span> [[ $? -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">        colorEcho <span class="variable">$&#123;RED&#125;</span> <span class="string">"Failed to extract V2Ray."</span></span><br><span class="line">        <span class="built_in">return</span> 2</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">if</span> [[ -d <span class="string">"/tmp/v2ray/v2ray-<span class="variable">$&#123;NEW_VER&#125;</span>-linux-<span class="variable">$&#123;VDIS&#125;</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">      VSRC_ROOT=<span class="string">"/tmp/v2ray/v2ray-<span class="variable">$&#123;NEW_VER&#125;</span>-linux-<span class="variable">$&#123;VDIS&#125;</span>"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1: new V2Ray. 0: no. 2: not installed. 3: check failed. 4: don't check.</span></span><br><span class="line"><span class="function"><span class="title">getVersion</span></span>()&#123;</span><br><span class="line">    <span class="keyword">if</span> [[ -n <span class="string">"<span class="variable">$VERSION</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">        NEW_VER=<span class="string">"<span class="variable">$VERSION</span>"</span></span><br><span class="line">        <span class="keyword">if</span> [[ <span class="variable">$&#123;NEW_VER&#125;</span> != v* ]]; <span class="keyword">then</span></span><br><span class="line">          NEW_VER=v<span class="variable">$&#123;NEW_VER&#125;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="built_in">return</span> 4</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        VER=`/usr/bin/v2ray/v2ray -version 2&gt;/dev/null`</span><br><span class="line">        RETVAL=<span class="string">"$?"</span></span><br><span class="line">        CUR_VER=`<span class="built_in">echo</span> <span class="variable">$VER</span> | head -n 1 | cut -d <span class="string">" "</span> -f2`</span><br><span class="line">        <span class="keyword">if</span> [[ <span class="variable">$&#123;CUR_VER&#125;</span> != v* ]]; <span class="keyword">then</span></span><br><span class="line">            CUR_VER=v<span class="variable">$&#123;CUR_VER&#125;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        TAG_URL=<span class="string">"https://api.github.com/repos/v2ray/v2ray-core/releases/latest"</span></span><br><span class="line">        NEW_VER=`curl <span class="variable">$&#123;PROXY&#125;</span> -s <span class="variable">$&#123;TAG_URL&#125;</span> --connect-timeout 10| grep <span class="string">'tag_name'</span> | cut -d\<span class="string">" -f4`</span></span><br><span class="line"><span class="string">        if [[ <span class="variable">$&#123;NEW_VER&#125;</span> != v* ]]; then</span></span><br><span class="line"><span class="string">          NEW_VER=v<span class="variable">$&#123;NEW_VER&#125;</span></span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        if [[ $? -ne 0 ]] || [[ <span class="variable">$NEW_VER</span> == "</span><span class="string">" ]]; then</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;RED&#125;</span> "</span>Failed to fetch release information. Please check your network or try again.<span class="string">"</span></span><br><span class="line"><span class="string">            return 3</span></span><br><span class="line"><span class="string">        elif [[ <span class="variable">$RETVAL</span> -ne 0 ]];then</span></span><br><span class="line"><span class="string">            return 2</span></span><br><span class="line"><span class="string">        elif [[ `echo <span class="variable">$NEW_VER</span> | cut -d. -f-2` != `echo <span class="variable">$CUR_VER</span> | cut -d. -f-2` ]];then</span></span><br><span class="line"><span class="string">            return 1</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        return 0</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">stopV2ray()&#123;</span></span><br><span class="line"><span class="string">    colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>Shutting down V2Ray service.<span class="string">"</span></span><br><span class="line"><span class="string">    if [[ -n "</span><span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span><span class="string">" ]] || [[ -f "</span>/lib/systemd/system/v2ray.service<span class="string">" ]] || [[ -f "</span>/etc/systemd/system/v2ray.service<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">        <span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span> stop v2ray</span></span><br><span class="line"><span class="string">    elif [[ -n "</span><span class="variable">$&#123;SERVICE_CMD&#125;</span><span class="string">" ]] || [[ -f "</span>/etc/init.d/v2ray<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">        <span class="variable">$&#123;SERVICE_CMD&#125;</span> v2ray stop</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;YELLOW&#125;</span> "</span>Failed to shutdown V2Ray service.<span class="string">"</span></span><br><span class="line"><span class="string">        return 2</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">startV2ray()&#123;</span></span><br><span class="line"><span class="string">    if [ -n "</span><span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span><span class="string">" ] &amp;&amp; [ -f "</span>/lib/systemd/system/v2ray.service<span class="string">" ]; then</span></span><br><span class="line"><span class="string">        <span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span> start v2ray</span></span><br><span class="line"><span class="string">    elif [ -n "</span><span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span><span class="string">" ] &amp;&amp; [ -f "</span>/etc/systemd/system/v2ray.service<span class="string">" ]; then</span></span><br><span class="line"><span class="string">        <span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span> start v2ray</span></span><br><span class="line"><span class="string">    elif [ -n "</span><span class="variable">$&#123;SERVICE_CMD&#125;</span><span class="string">" ] &amp;&amp; [ -f "</span>/etc/init.d/v2ray<span class="string">" ]; then</span></span><br><span class="line"><span class="string">        <span class="variable">$&#123;SERVICE_CMD&#125;</span> v2ray start</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;YELLOW&#125;</span> "</span>Failed to start V2Ray service.<span class="string">"</span></span><br><span class="line"><span class="string">        return 2</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">copyFile() &#123;</span></span><br><span class="line"><span class="string">    NAME=<span class="variable">$1</span></span></span><br><span class="line"><span class="string">    ERROR=`cp "</span><span class="variable">$&#123;VSRC_ROOT&#125;</span>/<span class="variable">$&#123;NAME&#125;</span><span class="string">" "</span>/usr/bin/v2ray/<span class="variable">$&#123;NAME&#125;</span><span class="string">" 2&gt;&amp;1`</span></span><br><span class="line"><span class="string">    if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;YELLOW&#125;</span> "</span><span class="variable">$&#123;ERROR&#125;</span><span class="string">"</span></span><br><span class="line"><span class="string">        return 1</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">makeExecutable() &#123;</span></span><br><span class="line"><span class="string">    chmod +x "</span>/usr/bin/v2ray/<span class="variable">$1</span><span class="string">"</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">installV2Ray()&#123;</span></span><br><span class="line"><span class="string">    # Install V2Ray binary to /usr/bin/v2ray</span></span><br><span class="line"><span class="string">    mkdir -p /usr/bin/v2ray</span></span><br><span class="line"><span class="string">    copyFile v2ray</span></span><br><span class="line"><span class="string">    if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;RED&#125;</span> "</span>Failed to copy V2Ray binary and resources.<span class="string">"</span></span><br><span class="line"><span class="string">        return 1</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    makeExecutable v2ray</span></span><br><span class="line"><span class="string">    copyFile v2ctl &amp;&amp; makeExecutable v2ctl</span></span><br><span class="line"><span class="string">    copyFile geoip.dat</span></span><br><span class="line"><span class="string">    copyFile geosite.dat</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    # Install V2Ray server config to /etc/v2ray</span></span><br><span class="line"><span class="string">    if [[ ! -f "</span>/etc/v2ray/config.json<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">        mkdir -p /etc/v2ray</span></span><br><span class="line"><span class="string">        mkdir -p /var/log/v2ray</span></span><br><span class="line"><span class="string">        cp "</span><span class="variable">$&#123;VSRC_ROOT&#125;</span>/vpoint_vmess_freedom.json<span class="string">" "</span>/etc/v2ray/config.json<span class="string">"</span></span><br><span class="line"><span class="string">        if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;YELLOW&#125;</span> "</span>Failed to create V2Ray configuration file. Please create it manually.<span class="string">"</span></span><br><span class="line"><span class="string">            return 1</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        let PORT=<span class="variable">$RANDOM</span>+10000</span></span><br><span class="line"><span class="string">        UUID=<span class="variable">$(cat /proc/sys/kernel/random/uuid)</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        sed -i "</span>s/10086/<span class="variable">$&#123;PORT&#125;</span>/g<span class="string">" "</span>/etc/v2ray/config.json<span class="string">"</span></span><br><span class="line"><span class="string">        sed -i "</span>s/23ad6b10-8d1a-40f7-8ad0-e3e35cd38297/<span class="variable">$&#123;UUID&#125;</span>/g<span class="string">" "</span>/etc/v2ray/config.json<span class="string">"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>PORT:<span class="variable">$&#123;PORT&#125;</span><span class="string">"</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>UUID:<span class="variable">$&#123;UUID&#125;</span><span class="string">"</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">installInitScript()&#123;</span></span><br><span class="line"><span class="string">    if [[ -n "</span><span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span><span class="string">" ]];then</span></span><br><span class="line"><span class="string">        if [[ ! -f "</span>/etc/systemd/system/v2ray.service<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">            if [[ ! -f "</span>/lib/systemd/system/v2ray.service<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">                cp "</span><span class="variable">$&#123;VSRC_ROOT&#125;</span>/systemd/v2ray.service<span class="string">" "</span>/etc/systemd/system/<span class="string">"</span></span><br><span class="line"><span class="string">                systemctl enable v2ray.service</span></span><br><span class="line"><span class="string">            fi</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        return</span></span><br><span class="line"><span class="string">    elif [[ -n "</span><span class="variable">$&#123;SERVICE_CMD&#125;</span><span class="string">" ]] &amp;&amp; [[ ! -f "</span>/etc/init.d/v2ray<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">        installSoftware "</span>daemon<span class="string">" || return $?</span></span><br><span class="line"><span class="string">        cp "</span><span class="variable">$&#123;VSRC_ROOT&#125;</span>/systemv/v2ray<span class="string">" "</span>/etc/init.d/v2ray<span class="string">"</span></span><br><span class="line"><span class="string">        chmod +x "</span>/etc/init.d/v2ray<span class="string">"</span></span><br><span class="line"><span class="string">        update-rc.d v2ray defaults</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    return</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Help()&#123;</span></span><br><span class="line"><span class="string">    echo "</span>./install-release.sh [-h] [-c] [--remove] [-p proxy] [-f] [--version vx.y.z] [-l file]<span class="string">"</span></span><br><span class="line"><span class="string">    echo "</span>  -h, --<span class="built_in">help</span>            Show <span class="built_in">help</span><span class="string">"</span></span><br><span class="line"><span class="string">    echo "</span>  -p, --proxy           To download through a proxy server, use -p socks5://127.0.0.1:1080 or -p http://127.0.0.1:3128 etc<span class="string">"</span></span><br><span class="line"><span class="string">    echo "</span>  -f, --force           Force install<span class="string">"</span></span><br><span class="line"><span class="string">    echo "</span>      --version         Install a particular version, use --version v3.15<span class="string">"</span></span><br><span class="line"><span class="string">    echo "</span>  -l, --<span class="built_in">local</span>           Install from a <span class="built_in">local</span> file<span class="string">"</span></span><br><span class="line"><span class="string">    echo "</span>      --remove          Remove installed V2Ray<span class="string">"</span></span><br><span class="line"><span class="string">    echo "</span>  -c, --check           Check <span class="keyword">for</span> update<span class="string">"</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">remove()&#123;</span></span><br><span class="line"><span class="string">    if [[ -n "</span><span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span><span class="string">" ]] &amp;&amp; [[ -f "</span>/etc/systemd/system/v2ray.service<span class="string">" ]];then</span></span><br><span class="line"><span class="string">        if pgrep "</span>v2ray<span class="string">" &gt; /dev/null ; then</span></span><br><span class="line"><span class="string">            stopV2ray</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        systemctl disable v2ray.service</span></span><br><span class="line"><span class="string">        rm -rf "</span>/usr/bin/v2ray<span class="string">" "</span>/etc/systemd/system/v2ray.service<span class="string">"</span></span><br><span class="line"><span class="string">        if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;RED&#125;</span> "</span>Failed to remove V2Ray.<span class="string">"</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;GREEN&#125;</span> "</span>Removed V2Ray successfully.<span class="string">"</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>If necessary, please remove configuration file and <span class="built_in">log</span> file manually.<span class="string">"</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">    elif [[ -n "</span><span class="variable">$&#123;SYSTEMCTL_CMD&#125;</span><span class="string">" ]] &amp;&amp; [[ -f "</span>/lib/systemd/system/v2ray.service<span class="string">" ]];then</span></span><br><span class="line"><span class="string">        if pgrep "</span>v2ray<span class="string">" &gt; /dev/null ; then</span></span><br><span class="line"><span class="string">            stopV2ray</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        systemctl disable v2ray.service</span></span><br><span class="line"><span class="string">        rm -rf "</span>/usr/bin/v2ray<span class="string">" "</span>/lib/systemd/system/v2ray.service<span class="string">"</span></span><br><span class="line"><span class="string">        if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;RED&#125;</span> "</span>Failed to remove V2Ray.<span class="string">"</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;GREEN&#125;</span> "</span>Removed V2Ray successfully.<span class="string">"</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>If necessary, please remove configuration file and <span class="built_in">log</span> file manually.<span class="string">"</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">    elif [[ -n "</span><span class="variable">$&#123;SERVICE_CMD&#125;</span><span class="string">" ]] &amp;&amp; [[ -f "</span>/etc/init.d/v2ray<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">        if pgrep "</span>v2ray<span class="string">" &gt; /dev/null ; then</span></span><br><span class="line"><span class="string">            stopV2ray</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        rm -rf "</span>/usr/bin/v2ray<span class="string">" "</span>/etc/init.d/v2ray<span class="string">"</span></span><br><span class="line"><span class="string">        if [[ $? -ne 0 ]]; then</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;RED&#125;</span> "</span>Failed to remove V2Ray.<span class="string">"</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;GREEN&#125;</span> "</span>Removed V2Ray successfully.<span class="string">"</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>If necessary, please remove configuration file and <span class="built_in">log</span> file manually.<span class="string">"</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        fi       </span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;YELLOW&#125;</span> "</span>V2Ray not found.<span class="string">"</span></span><br><span class="line"><span class="string">        return 0</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">checkUpdate()&#123;</span></span><br><span class="line"><span class="string">    echo "</span>Checking <span class="keyword">for</span> update.<span class="string">"</span></span><br><span class="line"><span class="string">    VERSION="</span><span class="string">"</span></span><br><span class="line"><span class="string">    getVersion</span></span><br><span class="line"><span class="string">    RETVAL="</span>$?<span class="string">"</span></span><br><span class="line"><span class="string">    if [[ <span class="variable">$RETVAL</span> -eq 1 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>Found new version <span class="variable">$&#123;NEW_VER&#125;</span> <span class="keyword">for</span> V2Ray.(Current version:<span class="variable">$CUR_VER</span>)<span class="string">"</span></span><br><span class="line"><span class="string">    elif [[ <span class="variable">$RETVAL</span> -eq 0 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>No new version. Current version is <span class="variable">$&#123;NEW_VER&#125;</span>.<span class="string">"</span></span><br><span class="line"><span class="string">    elif [[ <span class="variable">$RETVAL</span> -eq 2 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;YELLOW&#125;</span> "</span>No V2Ray installed.<span class="string">"</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>The newest version <span class="keyword">for</span> V2Ray is <span class="variable">$&#123;NEW_VER&#125;</span>.<span class="string">"</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">main()&#123;</span></span><br><span class="line"><span class="string">    #helping information</span></span><br><span class="line"><span class="string">    [[ "</span><span class="variable">$HELP</span><span class="string">" == "</span>1<span class="string">" ]] &amp;&amp; Help &amp;&amp; return</span></span><br><span class="line"><span class="string">    [[ "</span><span class="variable">$CHECK</span><span class="string">" == "</span>1<span class="string">" ]] &amp;&amp; checkUpdate &amp;&amp; return</span></span><br><span class="line"><span class="string">    [[ "</span><span class="variable">$REMOVE</span><span class="string">" == "</span>1<span class="string">" ]] &amp;&amp; remove &amp;&amp; return</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    sysArch</span></span><br><span class="line"><span class="string">    # extract local file</span></span><br><span class="line"><span class="string">    if [[ <span class="variable">$LOCAL_INSTALL</span> -eq 1 ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;YELLOW&#125;</span> "</span>Installing V2Ray via <span class="built_in">local</span> file. Please make sure the file is a valid V2Ray package, as we are not able to determine that.<span class="string">"</span></span><br><span class="line"><span class="string">        NEW_VER=local</span></span><br><span class="line"><span class="string">        installSoftware unzip || return $?</span></span><br><span class="line"><span class="string">        rm -rf /tmp/v2ray</span></span><br><span class="line"><span class="string">        extract <span class="variable">$LOCAL</span> || return $?</span></span><br><span class="line"><span class="string">        #FILEVDIS=`ls /tmp/v2ray |grep v2ray-v |cut -d "</span>-<span class="string">" -f4`</span></span><br><span class="line"><span class="string">        #SYSTEM=`ls /tmp/v2ray |grep v2ray-v |cut -d "</span>-<span class="string">" -f3`</span></span><br><span class="line"><span class="string">        #if [[ <span class="variable">$&#123;SYSTEM&#125;</span> != "</span>linux<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">        #    colorEcho <span class="variable">$&#123;RED&#125;</span> "</span>The <span class="built_in">local</span> V2Ray can not be installed <span class="keyword">in</span> linux.<span class="string">"</span></span><br><span class="line"><span class="string">        #    return 1</span></span><br><span class="line"><span class="string">        #elif [[ <span class="variable">$&#123;FILEVDIS&#125;</span> != <span class="variable">$&#123;VDIS&#125;</span> ]]; then</span></span><br><span class="line"><span class="string">        #    colorEcho <span class="variable">$&#123;RED&#125;</span> "</span>The <span class="built_in">local</span> V2Ray can not be installed <span class="keyword">in</span> <span class="variable">$&#123;ARCH&#125;</span> system.<span class="string">"</span></span><br><span class="line"><span class="string">        #    return 1</span></span><br><span class="line"><span class="string">        #else</span></span><br><span class="line"><span class="string">        #    NEW_VER=`ls /tmp/v2ray |grep v2ray-v |cut -d "</span>-<span class="string">" -f2`</span></span><br><span class="line"><span class="string">        #fi</span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">        # download via network and extract</span></span><br><span class="line"><span class="string">        installSoftware "</span>curl<span class="string">" || return $?</span></span><br><span class="line"><span class="string">        getVersion</span></span><br><span class="line"><span class="string">        RETVAL="</span>$?<span class="string">"</span></span><br><span class="line"><span class="string">        if [[ <span class="variable">$RETVAL</span> == 0 ]] &amp;&amp; [[ "</span><span class="variable">$FORCE</span><span class="string">" != "</span>1<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>Latest version <span class="variable">$&#123;NEW_VER&#125;</span> is already installed.<span class="string">"</span></span><br><span class="line"><span class="string">            if [[ "</span><span class="variable">$&#123;ERROR_IF_UPTODATE&#125;</span><span class="string">" == "</span>1<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">              return 10</span></span><br><span class="line"><span class="string">            fi</span></span><br><span class="line"><span class="string">            return</span></span><br><span class="line"><span class="string">        elif [[ <span class="variable">$RETVAL</span> == 3 ]]; then</span></span><br><span class="line"><span class="string">            return 3</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">            colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>Installing V2Ray <span class="variable">$&#123;NEW_VER&#125;</span> on <span class="variable">$&#123;ARCH&#125;</span><span class="string">"</span></span><br><span class="line"><span class="string">            downloadV2Ray || return $?</span></span><br><span class="line"><span class="string">            installSoftware unzip || return $?</span></span><br><span class="line"><span class="string">            extract <span class="variable">$&#123;ZIPFILE&#125;</span> || return $?</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">    fi </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if [[ "</span><span class="variable">$&#123;EXTRACT_ONLY&#125;</span><span class="string">" == "</span>1<span class="string">" ]]; then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;GREEN&#125;</span> "</span>V2Ray extracted to <span class="variable">$&#123;VSRC_ROOT&#125;</span>, and exiting...<span class="string">"</span></span><br><span class="line"><span class="string">        return 0</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if pgrep "</span>v2ray<span class="string">" &gt; /dev/null ; then</span></span><br><span class="line"><span class="string">        V2RAY_RUNNING=1</span></span><br><span class="line"><span class="string">        stopV2ray</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    installV2Ray || return $?</span></span><br><span class="line"><span class="string">    installInitScript || return $?</span></span><br><span class="line"><span class="string">    if [[ <span class="variable">$&#123;V2RAY_RUNNING&#125;</span> -eq 1 ]];then</span></span><br><span class="line"><span class="string">        colorEcho <span class="variable">$&#123;BLUE&#125;</span> "</span>Restarting V2Ray service.<span class="string">"</span></span><br><span class="line"><span class="string">        startV2ray</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">    colorEcho <span class="variable">$&#123;GREEN&#125;</span> "</span>V2Ray <span class="variable">$&#123;NEW_VER&#125;</span> is installed.<span class="string">"</span></span><br><span class="line"><span class="string">    rm -rf /tmp/v2ray</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">main</span></span><br></pre></td></tr></table></figure>


      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Payton">
            
              <p class="site-author-name" itemprop="name">Payton</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#技术原理"><span class="nav-number">1.1.</span> <span class="nav-text">技术原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#访问外网的姿势"><span class="nav-number">1.2.</span> <span class="nav-text">访问外网的姿势</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#歪批嗯"><span class="nav-number">1.2.1.</span> <span class="nav-text">歪批嗯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正向代理"><span class="nav-number">1.2.2.</span> <span class="nav-text">正向代理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#机场-软件"><span class="nav-number">1.2.3.</span> <span class="nav-text">机场 / 软件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#各种专门的协议"><span class="nav-number">1.2.4.</span> <span class="nav-text">各种专门的协议</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安全须知"><span class="nav-number">2.</span> <span class="nav-text">安全须知</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#不要用360和百度"><span class="nav-number">2.1.</span> <span class="nav-text">不要用360和百度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不要用国内浏览器"><span class="nav-number">2.2.</span> <span class="nav-text">不要用国内浏览器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#浏览器打开「不跟踪」请求"><span class="nav-number">2.3.</span> <span class="nav-text">浏览器打开「不跟踪」请求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#更改系统语言（可选）"><span class="nav-number">2.4.</span> <span class="nav-text">更改系统语言（可选）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#初级玩家——现成服务器"><span class="nav-number">3.</span> <span class="nav-text">初级玩家——现成服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#免费软件"><span class="nav-number">3.1.</span> <span class="nav-text">免费软件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#电脑用户"><span class="nav-number">3.1.1.</span> <span class="nav-text">电脑用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#无界浏览"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">无界浏览</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#JJQQKK"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">JJQQKK</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#歪批嗯-Plus-Hotspot-Shield"><span class="nav-number">3.1.1.3.</span> <span class="nav-text">歪批嗯 Plus / Hotspot Shield</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#手机用户"><span class="nav-number">3.1.2.</span> <span class="nav-text">手机用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Betternet-歪批嗯-360"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">Betternet / 歪批嗯 360</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#歪批嗯-plus"><span class="nav-number">3.1.2.2.</span> <span class="nav-text">歪批嗯 plus</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#老王歪批嗯"><span class="nav-number">3.1.2.3.</span> <span class="nav-text">老王歪批嗯</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置代理"><span class="nav-number">3.2.</span> <span class="nav-text">配置代理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#寻找代理节点"><span class="nav-number">3.2.1.</span> <span class="nav-text">寻找代理节点</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#通过网站"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">通过网站</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#通过工具"><span class="nav-number">3.2.1.2.</span> <span class="nav-text">通过工具</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置网络代理"><span class="nav-number">3.2.2.</span> <span class="nav-text">配置网络代理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#设置软件代理"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">设置软件代理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设置IE代理"><span class="nav-number">3.2.2.2.</span> <span class="nav-text">设置IE代理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设置全局代理"><span class="nav-number">3.2.2.3.</span> <span class="nav-text">设置全局代理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设置浏览器代理"><span class="nav-number">3.2.2.4.</span> <span class="nav-text">设置浏览器代理</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#收费渠道"><span class="nav-number">3.3.</span> <span class="nav-text">收费渠道</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#收费软件"><span class="nav-number">3.3.1.</span> <span class="nav-text">收费软件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#收费机场"><span class="nav-number">3.3.2.</span> <span class="nav-text">收费机场</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#进阶玩家——自建服务器"><span class="nav-number">4.</span> <span class="nav-text">进阶玩家——自建服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#自己做「机场主」"><span class="nav-number">4.1.</span> <span class="nav-text">自己做「机场主」</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么用GCP"><span class="nav-number">4.2.</span> <span class="nav-text">为什么用GCP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#申请GCP"><span class="nav-number">4.3.</span> <span class="nav-text">申请GCP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#准备一张Visa-万事达信用卡"><span class="nav-number">4.3.1.</span> <span class="nav-text">准备一张Visa / 万事达信用卡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#生成境外地址"><span class="nav-number">4.3.2.</span> <span class="nav-text">生成境外地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#准备外网环境"><span class="nav-number">4.3.3.</span> <span class="nav-text">准备外网环境</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#进入注册"><span class="nav-number">4.3.4.</span> <span class="nav-text">进入注册</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用GCP搭建服务器"><span class="nav-number">4.4.</span> <span class="nav-text">用GCP搭建服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建防火墙规则"><span class="nav-number">4.4.1.</span> <span class="nav-text">创建防火墙规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建VM实例"><span class="nav-number">4.4.2.</span> <span class="nav-text">创建VM实例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在VM实例上搭建协议"><span class="nav-number">4.4.3.</span> <span class="nav-text">在VM实例上搭建协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#v2ray客户端的使用"><span class="nav-number">4.4.4.</span> <span class="nav-text">v2ray客户端的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Windows用户"><span class="nav-number">4.4.4.1.</span> <span class="nav-text">Windows用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Mac用户"><span class="nav-number">4.4.4.2.</span> <span class="nav-text">Mac用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Android用户"><span class="nav-number">4.4.4.3.</span> <span class="nav-text">Android用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#iOS用户"><span class="nav-number">4.4.4.4.</span> <span class="nav-text">iOS用户</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux用户使用"><span class="nav-number">4.4.5.</span> <span class="nav-text">Linux用户使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#配置代理-1"><span class="nav-number">4.4.5.1.</span> <span class="nav-text">配置代理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#连接到已搭建v2ray的服务器"><span class="nav-number">4.4.5.2.</span> <span class="nav-text">连接到已搭建v2ray的服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#安装v2ray"><span class="nav-number">4.4.5.2.1.</span> <span class="nav-text">安装v2ray</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#使用v2ray"><span class="nav-number">4.4.5.2.2.</span> <span class="nav-text">使用v2ray</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录"><span class="nav-number">5.</span> <span class="nav-text">附录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#如何寻找美区Apple-ID、下载美区付费软件"><span class="nav-number">5.1.</span> <span class="nav-text">如何寻找美区Apple ID、下载美区付费软件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拓展"><span class="nav-number">5.2.</span> <span class="nav-text">拓展</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#其它v2ray-SS的iOS客户端"><span class="nav-number">5.2.1.</span> <span class="nav-text">其它v2ray / SS的iOS客户端</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#全局-直连-规则模式"><span class="nav-number">5.2.2.</span> <span class="nav-text">全局 / 直连 / 规则模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VPS"><span class="nav-number">5.2.3.</span> <span class="nav-text">VPS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一点忠告"><span class="nav-number">5.3.</span> <span class="nav-text">一点忠告</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#v2ray配置脚本go-sh"><span class="nav-number">5.4.</span> <span class="nav-text">v2ray配置脚本go.sh</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-comments"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Payton</span>

  

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  








  













  



  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="/lib/fancybox/source/jquery.fancybox.pack.js"></script>

  
  <script src="/lib/reading_progress/reading_progress.js"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/affix.js?v=7.1.1"></script>

  <script src="/js/schemes/pisces.js?v=7.1.1"></script>




  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
